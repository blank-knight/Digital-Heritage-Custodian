# 数字遗产托管员 - 简化Demo架构

## 系统架构图

```
┌─────────────────────────────────────────────────────────────┐
│                    Web 应用层 (Frontend)                     │
├─────────────────────────────────────────────────────────────┤
│  React Web App  │  Web3 集成  │  钱包连接  │  用户界面      │
└─────────────────────────────────────────────────────────────┘
                                │
┌─────────────────────────────────────────────────────────────┐
│                   智能合约层 (Smart Contract Layer)           │
├─────────────────────────────────────────────────────────────┤
│  继承主合约  │  心跳检测合约  │  资产合约  │  时间锁合约  │  多签合约  │
└─────────────────────────────────────────────────────────────┘
                                │
┌─────────────────────────────────────────────────────────────┐
│                    Monad 区块链网络                          │
├─────────────────────────────────────────────────────────────┤
│  测试网合约  │  链上存储  │  事件监听  │  状态查询  │  交易记录  │
└─────────────────────────────────────────────────────────────┘
```

## 核心组件说明

### 1. 智能合约模块
- **继承主合约**：管理整个继承流程和资产转移
- **心跳检测合约**：监控用户地址的链上活动
- **资产合约**：管理ERC-20代币和NFT资产
- **时间锁合约**：实现渐进式资产释放（10% → 20% → 70%）
- **多签合约**：白名单验证者管理和多重签名验证

### 2. 链上活动检测机制
- **签名活动监控**：检测用户地址的transaction活动
- **心跳检测**：90天无活动触发继承流程
- **简单触发**：无复杂保护机制，直接执行继承

## 数据流图

```
用户配置 → 智能合约部署 → Monad测试网
    ↓
链上活动监控 → 90天无活动检测 → 触发继承流程
    ↓
白名单验证 → 多重签名确认 → 资产释放
    ↓
渐进式释放 → 继承人接收 → 完成继承
```

## 核心功能流程

### 1. 用户配置阶段
- 用户连接钱包（MetaMask等）
- 设置继承人地址
- 配置白名单验证者（3-5人）
- 选择资产类型和释放比例
- 部署智能合约到Monad测试网

### 2. 心跳监控阶段
- 智能合约持续监控用户地址活动
- 记录最后一次交易时间戳
- 90天无活动触发继承流程
- 180天假死保护期

### 3. 继承触发阶段
- 白名单验证者收到通知
- 至少2/3验证者确认用户死亡
- 多重签名验证通过
- 启动资产转移流程

### 4. 资产释放阶段
- 立即释放10%资产
- 3个月后释放20%资产
- 12个月后释放70%资产
- 完成继承流程

## 技术栈

### 前端技术
- **React.js**：Web应用框架
- **Web3.js/Ethers.js**：区块链交互
- **MetaMask**：钱包连接
- **Tailwind CSS**：UI样式
- **Vite**：构建工具

### 智能合约技术
- **Solidity**：智能合约开发语言
- **Hardhat**：开发框架
- **OpenZeppelin**：安全合约库
- **Monad SDK**：Monad网络集成

### 部署环境
- **Monad测试网**：开发和测试环境
- **Monad主网**：生产环境
- **IPFS**：去中心化存储（可选）

## Monad网络集成

### 网络配置
```javascript
// Monad测试网配置
const monadTestnet = {
  chainId: '0x1a4', // 420
  chainName: 'Monad Testnet',
  rpcUrls: ['https://testnet-rpc.monad.xyz'],
  blockExplorerUrls: ['https://testnet-explorer.monad.xyz']
}
```

### 合约部署
- 继承主合约：管理整体流程
- 心跳检测合约：监控用户活动
- 资产管理合约：处理ERC-20/NFT
- 时间锁合约：渐进式释放
- 多签合约：验证者管理

## 安全机制

### 1. 链上验证
- 基于区块链的不可篡改记录
- 智能合约自动执行，无需人工干预
- 公开透明的验证过程

### 2. 多重签名保护
- 至少3个独立验证者
- 需要2/3或3/5同意才能触发
- 防止单点故障和恶意行为

### 3. 时间锁机制
- 假死保护期：180天
- 复活机制：30天内可取消
- 渐进式释放：防止即时纠纷

## 开发计划

### 阶段1：基础合约开发
- 继承主合约
- 心跳检测合约
- 基础测试

### 阶段2：前端开发
- React Web应用
- 钱包集成
- 用户界面

### 阶段3：Monad网络集成
- 测试网部署
- 网络适配
- 功能测试

### 阶段4：安全审计
- 合约审计
- 漏洞修复
- 主网部署
